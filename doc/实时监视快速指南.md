# VS Code 实时变量监视快速设置指南

## 🚀 立即开始使用

你的 VS Code 调试配置已经启用了实时变量监视功能！现在就可以开始使用了。

## ⚡ 快速步骤

### 1. 启动调试
```
1. 按 Ctrl+Shift+D 打开调试视图
2. 选择 "Debug STM32 (J-Link)" 配置
3. 按 F5 开始调试
```

### 2. 添加变量监视
在你的代码中，任何变量都可以添加到监视窗口：

#### 方法一：从代码直接添加
1. 在代码中选中变量名（如 `counter`, `a`）
2. 右键 → "Add to Watch"

#### 方法二：手动输入
1. 在左侧调试面板找到 "WATCH" 区域
2. 点击 "+" 号
3. 输入变量名，按回车

### 3. 查看实时变化
- 程序运行时，监视窗口的变量值会**实时更新**
- 不需要暂停程序或设置断点
- 变化的值会高亮显示

## 📊 功能特点

### ✅ 已启用的功能
- **Live Watch**: 实时变量监视（4次/秒更新）
- **SWO 输出**: 实时 printf 调试信息
- **RTT 支持**: 高速数据传输
- **DWT 追踪**: 硬件级变量监视

### 🎯 与 Keil 相比的优势
| 功能 | Keil | VS Code (现在) |
|------|------|----------------|
| 实时变量监视 | ✅ | ✅ |
| 程序运行中更新 | ✅ | ✅ |
| 多变量同时监视 | ✅ | ✅ |
| 图形化波形显示 | ✅ | ✅ |
| SWO 调试输出 | ✅ | ✅ |
| 免费使用 | ❌ | ✅ |

## 🔧 在你的代码中测试

### 快速测试变量
在你现有的 `main.c` 中，`a` 变量已经可以监视：

```c
uint32_t a = 0;
int main() {
    while (1) {
        a++;  // ← 监视这个变量的实时变化
    }
}
```

### 添加更多测试变量
```c
volatile int counter = 0;
volatile float value = 0.0;

int main() {
    while (1) {
        counter++;
        value += 0.1;
        a++;
        
        // 添加简单延时以便观察变化
        for(int i = 0; i < 100000; i++) __NOP();
    }
}
```

## 🎮 调试面板使用

### Variables 面板
- **Locals**: 当前函数的局部变量
- **Globals**: 全局变量（如你的 `a`）
- **Statics**: 静态变量

### Watch 面板
- 手动添加的监视变量
- **实时更新**，无需暂停程序
- 支持表达式（如 `a*2`, `counter+100`）

### 调试控制
- **继续运行** (F5): 程序持续运行，变量实时更新
- **暂停** (F6): 暂停查看当前状态
- **单步** (F10/F11): 逐步执行

## 💡 使用技巧

### 1. 变量命名建议
```c
volatile uint32_t counter;        // 使用 volatile 防止优化
volatile int sensor_reading;      // 描述性命名
volatile float temperature_c;     // 单位在名称中
```

### 2. 观察变化模式
- **递增变量**: 观察增长速度
- **传感器数据**: 查看数值范围和变化
- **状态变量**: 监视状态切换

### 3. 性能考虑
- 监视的变量数量不会明显影响性能
- J-Link 的硬件支持确保高效监视
- 如有需要可以调整采样频率

## 🔍 故障排除

### 变量不更新？
1. 确保程序在运行（不是暂停状态）
2. 检查变量是否在当前作用域
3. 使用 `volatile` 关键字防止编译器优化

### 找不到变量？
1. 确保变量名拼写正确
2. 检查变量是否在当前函数作用域内
3. 全局变量在 "Globals" 区域查找

### 更新太快或太慢？
- 当前设置为每秒4次更新
- 可以通过修改 `launch.json` 中的 `samplesPerSecond` 调整

## ✨ 立即体验

现在就可以：
1. 启动调试 (F5)
2. 在 Watch 面板添加 `a` 变量
3. 观察它的实时变化！

享受像 Keil 一样流畅的实时调试体验！ 🎉
